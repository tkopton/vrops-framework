<?xml version='1.0' encoding='UTF-8'?>
<dunes-script-module name="processTemplate" result-type="Any" api-version="6.0.0" id="com.vmware.pscoe.library.util.processTemplate" version="2.11.2" allowed-operations="evf" category-name="com.vmware.pscoe.library.util">
  <description><![CDATA[
 @param template
 @param vars
 @param pattern
]]></description>
  <param n="template" t="Any"><![CDATA[]]></param>
  <param n="vars" t="Any"><![CDATA[]]></param>
  <param n="pattern" t="Any"><![CDATA[]]></param>
  <script encoded="false"><![CDATA[if (!pattern || pattern == "") {
	pattern = "\"#{\" + variable + \"}\"";
}
var beforePattern = pattern.split("variable")[0];
var afterPattern = pattern.split("variable")[1];
beforePattern = beforePattern.replace(/\+/g, "").trim().replace(/\"/g, "");
afterPattern = afterPattern.replace(/\+/g, "").trim().replace(/\"/g, "");

var result = template;
for (var i in vars.keys) {
	var variable = vars.keys[i];
	var value = vars.get(variable);
	result = result.replace(new RegExp(beforePattern + variable + afterPattern, "g"), value);
}
return result;
]]></script>
</dunes-script-module>